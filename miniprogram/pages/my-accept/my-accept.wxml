<!-- pages/my-accept/my-accept.wxml -->
<view class="my-accept-page">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <view class="header-back" bindtap="goBack">
      <text>â€¹</text>
    </view>
    <text class="page-title">æˆ‘æ¥å•çš„ä»»åŠ¡</text>
  </view>

  <!-- ä»»åŠ¡ç­›é€‰ -->
  <view class="filter-section">
    <view class="filter-tabs">
      <view 
        class="filter-tab {{currentFilter === 'all' ? 'active' : ''}}" 
        bindtap="changeFilter" 
        data-filter="all"
      >
        å…¨éƒ¨ ({{taskStats.total || 0}})
      </view>
      <view 
        class="filter-tab {{currentFilter === 'inprogress' ? 'active' : ''}}" 
        bindtap="changeFilter" 
        data-filter="inprogress"
      >
        è¿›è¡Œä¸­ ({{taskStats.inprogress || 0}})
      </view>
      <view 
        class="filter-tab {{currentFilter === 'completed' ? 'active' : ''}}" 
        bindtap="changeFilter" 
        data-filter="completed"
      >
        å·²å®Œæˆ ({{taskStats.completed || 0}})
      </view>
    </view>
  </view>

  <!-- ä»»åŠ¡åˆ—è¡¨ -->
  <scroll-view class="task-list" scroll-y>
    <!-- ä»»åŠ¡é¡¹ -->
    <view class="task-item" wx:for="{{taskList}}" wx:key="id" bindtap="viewTaskDetail" data-id="{{item.id}}">
      <view class="task-header">
        <view class="task-type {{item.type}}">
          <text>{{item.type === 'express' ? 'å¿«é€’' : item.type === 'buy' ? 'ä»£ä¹°' : 'ä»£åŠ'}}</text>
        </view>
        <text class="task-status {{item.status}}">{{getStatusText(item.status)}}</text>
        <text class="task-reward">Â¥{{item.reward}}</text>
      </view>
      
      <view class="task-content">
        <text class="task-title">{{item.title}}</text>
        <view class="task-info">
          <text class="info-item">ğŸ“… {{item.createTime}}</text>
          <text class="info-item">â±ï¸ {{item.deadline}}</text>
        </view>
        
        <view class="task-location">
          <text>å–ä»¶: {{item.pickupLocation}}</text>
          <text>é€è¾¾: {{item.deliveryLocation}}</text>
        </view>
        
        <view class="task-publisher">
          <text>å‘å¸ƒäºº: {{item.publisher.name}}</text>
          <text>ç”µè¯: {{item.publisher.phone}}</text>
        </view>
      </view>
      
      <view class="task-footer">
        <view class="task-actions">
          <button 
            wx:if="{{item.status === 'accepted'}}" 
            class="action-btn complete" 
            bindtap="completeTask" 
            data-id="{{item.id}}"
          >
            æ ‡è®°å®Œæˆ
          </button>
          <button 
            wx:if="{{item.status === 'accepted'}}" 
            class="action-btn cancel" 
            bindtap="cancelAccept" 
            data-id="{{item.id}}"
          >
            å–æ¶ˆæ¥å•
          </button>
          <button 
            wx:if="{{item.status === 'completed' && !item.isRated}}" 
            class="action-btn rate" 
            bindtap="ratePublisher" 
            data-id="{{item.id}}"
          >
            è¯„ä»·å‘å¸ƒäºº
          </button>
          <button 
            wx:if="{{item.status === 'completed' && item.isRated}}" 
            class="action-btn view" 
            bindtap="viewTaskDetail" 
            data-id="{{item.id}}"
          >
            æŸ¥çœ‹è¯¦æƒ…
          </button>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{taskList.length === 0}}" class="empty-state">
      <view class="empty-icon">ğŸ¤</view>
      <text class="empty-title">æš‚æ— æ¥å•çš„ä»»åŠ¡</text>
      <text class="empty-desc">å¿«å»é¦–é¡µæ¥å–ä»»åŠ¡å§ï¼</text>
      <button class="empty-btn" bindtap="goToIndex">å»é¦–é¡µæ¥å•</button>
    </view>
  </scroll-view>
</view>